@model PetClinicSystem.Models.AppointmentViewModel

@{
    ViewData["Title"] = (ViewData["Action"] as string) == "Schedule" ? "Schedule New Appointment" : "Edit Appointment";
    ViewData["ActivePage"] = "Appointments";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-md-6">
            <h2 class="page-title">
                <i class="fas fa-calendar-plus me-2"></i>@ViewData["Title"]
            </h2>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-body">
            <form asp-action="@ViewData["Action"]">
                <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>

               @*  @if (ViewData["Action"].ToString() == "Edit")
                {
                    <input type="hidden" asp-for="AppointmentId" />
                } *@

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label asp-for="PatientId" class="form-label"></label>
                            <select asp-for="PatientId" class="form-select" asp-items="Model.AvailablePets">
                                <option value="">Select Patient</option>
                            </select>
                            <span asp-validation-for="PatientId" class="text-danger"></span>
                        </div>

                        <div class="mb-3">
                            <label asp-for="VetId" class="form-label">Veterinarian</label>
                            <select asp-for="VetId" class="form-select" asp-items="Model.AvailableVets">
                                <option value="">Select Veterinarian</option>
                            </select>
                            <span asp-validation-for="VetId" class="text-danger"></span>
                        </div>

                        <div class="mb-3">
                            <label asp-for="AppointmentDate" class="form-label"></label>
                            <input asp-for="AppointmentDate" type="datetime-local" class="form-control" />
                            <span asp-validation-for="AppointmentDate" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="mb-3">
                            <label asp-for="Duration" class="form-label"></label>
                            <select asp-for="Duration" class="form-select">
                                <option value="15">15 minutes</option>
                                <option value="30" selected>30 minutes</option>
                                <option value="45">45 minutes</option>
                                <option value="60">60 minutes</option>
                            </select>
                            <span asp-validation-for="Duration" class="text-danger"></span>
                        </div>

                        <div class="mb-3">
                            <label asp-for="Reason" class="form-label"></label>
                            <input asp-for="Reason" class="form-control" />
                            <span asp-validation-for="Reason" class="text-danger"></span>
                        </div>

                        <div class="mb-3">
                            <label asp-for="Notes" class="form-label"></label>
                            <textarea asp-for="Notes" class="form-control" rows="3"></textarea>
                            <span asp-validation-for="Notes" class="text-danger"></span>
                        </div>
                    </div>
                </div>

                <div class="d-flex justify-content-between mt-4">
                    <a asp-action="Index" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Cancel
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Save
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

 
    <script>
        $(document).ready(function() {
            // Debug form submission
            $('form').on('submit', function(e) {
                console.log("Form submitted!");
                console.log("Form data:", $(this).serialize());
                
                // Verify required fields
                const vetId = $('#VetId').val();
                const patientId = $('#PatientId').val();
                console.log(`VetID: ${vetId}, PatientID: ${patientId}`);
                
                if (!vetId || !patientId) {
                    console.error("Required fields are missing!");
                }
            });

            // Debug button click
            $('button[type="submit"]').click(function() {
                console.log("Save button clicked");
            });
        });
    </script>

}